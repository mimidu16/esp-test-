<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Suivi Élèves</title>
</head>
<body>
  <h2>Suivi Tenue</h2>
  <table id="tableTenue"></table>

  <h2>Suivi Attitude</h2>
  <table id="tableAttitude"></table>

  <script>
    const API_URL = "TON_URL_APPS_SCRIPT"; // <-- colle ton URL déployé ici
    const eleves = ["Isabelle", "Luis", "Miguel", "Amélia", "Dïamond", "Lorèna"];
    const nbSeances = 12;

    const tbodyTenue = document.getElementById("tableTenue");
    const tbodyAtt = document.getElementById("tableAttitude");

    // Créer les tableaux
    function creerTables() {
      eleves.forEach(nom => {
        let trT = document.createElement("tr");
        trT.innerHTML = `<td>${nom}</td>` + 
          Array.from({length: nbSeances}, (_,j) => `<td><select>
            <option value="oui">Oui</option>
            <option value="non">Non</option>
          </select></td>`).join("");
        tbodyTenue.appendChild(trT);

        let trA = document.createElement("tr");
        trA.innerHTML = `<td>${nom}</td>` + 
          Array.from({length: nbSeances}, (_,j) => `<td><select>
            <option value="neutre">Neutre</option>
            <option value="bonne">Bonne</option>
            <option value="mauvaise">Mauvaise</option>
          </select></td>`).join("");
        tbodyAtt.appendChild(trA);
      });
    }

    // Charger les données depuis Sheets
    async function loadData() {
      try {
        const resTenue = await fetch(API_URL + "?sheet=Suivi tenue");
        const dataTenue = await resTenue.json();

        const resAtt = await fetch(API_URL + "?sheet=Suivi attitude");
        const dataAtt = await resAtt.json();

        eleves.forEach((nom, i) => {
          // Tenue
          if (dataTenue[nom]) {
            tbodyTenue.querySelectorAll("tr")[i].querySelectorAll("select")
              .forEach((s, j) => s.value = (dataTenue[nom][j] || "oui").toLowerCase());
          }
          // Attitude
          if (dataAtt[nom]) {
            tbodyAtt.querySelectorAll("tr")[i].querySelectorAll("select")
              .forEach((s, j) => s.value = (dataAtt[nom][j] || "neutre").toLowerCase());
          }
        });
      } catch (err) {
        console.error("Erreur loadData", err);
      }
    }

    // Sauvegarder dans Sheets
    async function saveData() {
      eleves.forEach((nom, i) => {
        const tenue = Array.from(tbodyTenue.querySelectorAll("tr")[i].querySelectorAll("select")).map(s => s.value);
        const attitude = Array.from(tbodyAtt.querySelectorAll("tr")[i].querySelectorAll("select")).map(s => s.value);

        fetch(API_URL, {
          method: "POST",
          body: JSON.stringify({ eleve: nom, tenue, attitude })
        });
      });
    }

    // Init
    creerTables();
    loadData();

    // Sauvegarde auto à chaque changement
    document.addEventListener("change", saveData);
  </script>
</body>
</html>
